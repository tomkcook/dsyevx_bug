    program dsyevx_bug
        implicit none

        double precision :: test
        double precision, dimension(2) :: test_result

        test_result(1) = test(.TRUE., .TRUE., .TRUE., .TRUE.)
        WRITE(*,*) 'Alignments are AAAA and the sum of the output matrix is: ', test_result(1)
        test_result(2) = test(.FALSE., .TRUE., .TRUE., .TRUE.)
        WRITE(*,*) 'Alignments are UAAA and the sum of the output matrix is: ', test_result(2)
        
        if(test_result(1) .NE. test_result(2)) then
            write(*,*) '*** Output matrices for aligned and unaligned cases do not match ***'
        end if

    end program

    subroutine SETUP_ALIGN(X, X_ALIGNED, ALIGNED, LENGTH)
        implicit none

        double precision, dimension(*), target :: X
        double precision, pointer :: X_ALIGNED(:)
        logical :: ALIGNED
        integer :: LENGTH

        if(ALIGNED) then
            if (LOC(X).AND.15.NE.0) then
                X_ALIGNED => X(2:LENGTH+1)
            else
                X_ALIGNED => X(1:LENGTH)
            end if
        else
            if (LOC(X).AND.15.EQ.0) then
                X_ALIGNED => X(2:LENGTH+1)
            else
                X_ALIGNED => X(1:LENGTH)
            end if
        end if
    end subroutine
    
    function sum_mat(A, LENGTH)
        double precision :: sum_mat
        integer :: LENGTH, II
        double precision, dimension(LENGTH) :: A
        
        sum_mat = 0
        do 50 II = 1, LENGTH
            sum_mat = sum_mat + A(II)
50      continue
    end function

    recursive function test(AL_A, AL_WW, AL_ZZ, AL_WORK)

        double precision :: test

        logical AL_A, AL_WW, AL_ZZ, AL_WORK

        double precision, dimension(48*48) :: A_original = (/ &
            0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0, &
            0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0_8, -0.105409255338946_8, 0_8, 0_8, 0_8, 0_8, 0_8, 0.210818510677892_8 &
            /)
    
        double precision, dimension(48*48+1), target :: A, ZZ
        double precision, dimension(49), target :: WW
        integer, dimension(5*48) :: IWORK
        integer, dimension(48) :: IFAIL

        integer :: M, N, LDA, LDZ, INFO, LWORK, II
        double precision :: ABSTOL, DWORK, A_SUM
        double precision, allocatable, target :: WORK(:)

        double precision, pointer :: PA(:), PZZ(:), PWW(:), PWORK(:)
    
        parameter(N=48, LDA=48, LDZ=48)

        interface
            subroutine SETUP_ALIGN(X, X_ALIGNED, ALIGNED, LENGTH)
                double precision, dimension(*), target :: X
                double precision, pointer :: X_ALIGNED(:)
                logical :: ALIGNED
                integer :: LENGTH
            end subroutine
        end interface

        ABSTOL = 2.0_8 * DLAMCH('S')

        if (AL_A) then
            if (LOC(A).AND.15.EQ.0) then
                A(1:48*48) = A_original
                PA => A(1:48*48)
            else
                A(2:48*48+1) = A_original
                PA => A(2:48*48+1)
            end if
        else
            if (LOC(A).AND.15.EQ.0) then
                A(2:48*48+1) = A_original
                PA => A(2:48*48+1)
            else
                A(1:48*48) = A_original
                PA => A(1:48*48)
            end if
        end if

        WW = 0
        ZZ = 0

        !    call SETUP_ALIGN(A, PA, AL_A, 48*48)
        call SETUP_ALIGN(WW, PWW, AL_WW, 48)
        call SETUP_ALIGN(ZZ, PZZ, AL_ZZ, 48*48)

        A_SUM = sum_mat(A_original, 48*48)
        write(*, *) 'Sum of the literal A matrix is: ', A_SUM
        A_SUM = sum_mat(PA, 48*48)
        write(*, *) 'Sum of the input A matrix is: ', A_SUM
        write(*, *) 'PA is offset from A by: ', (LOC(PA) - LOC(A)), ' bytes because AL_A is ', AL_A

        call DSYEVX('V', 'V', 'L', N, PA, LDA, -1e-12_8, 1e-12_8, 0, 0, ABSTOL, M, PWW, PZZ, LDZ, DWORK, -1, IWORK, IFAIL, INFO)
        LWORK = int(DWORK)
        allocate(WORK(LWORK+1))

        call SETUP_ALIGN(WORK, PWORK, AL_WORK, LWORK)

        call DSYEVX('V', 'V', 'L', N, PA, LDA, -1e-12_8, 1e-12_8, 0, 0, ABSTOL, M, PWW, PZZ, LDZ, WORK, LWORK, IWORK, IFAIL, INFO)

        test = 0

        A_SUM = 0

        do 20 II = 1, 48*48
            A_SUM = A_SUM + PA(II)
    20  continue

        test = A_SUM
    end function